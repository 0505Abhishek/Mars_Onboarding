<%- include("../shared/header.ejs") %>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<style>
    .modal-backdrop {
        display: none !important;
    }

    .modal-body {
        max-height: 440px;
        overflow-y: auto;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th, td {
        border: 1px solid #ccc;
        padding: 10px;
        text-align: center;
    }

    .view-icon {
        cursor: pointer;
        font-size: 20px;
    }

    .table-dark th {
        color: #0000A0 !important;
        background-color: #E0E0FC;
        border: 1px solid rgb(224, 203, 203);
    }

    #documentTable tbody tr:nth-child(odd) td {
        background: #FFFFFF !important;
    }

    #documentTable tbody tr:nth-child(even) td {
        background: #EFEFFF !important;
    }

    .action-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
    }
    .custom-blue {
        background-color: #007BFF !important;
        color: white !important;
        border: none !important;
    }
</style>

<style>
    .back-link {
        font-size: 1.5rem;
        font-weight: 500;
        text-decoration: none;
        color: #1a1a1a; /* Adjust color as per your design */
        display: flex;
        align-items: center;
        margin-bottom:20px;
    }

    .back-link i {
        font-size: 20px;
        margin-right: 8px;
    }
</style>


<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center">
        <a href="/distributorList" class="back-link">
            <i class="fa fa-angle-left"></i> Document Verification
        </a>
    </div>
    <div class="table-responsive">
        <table id="documentTable">
            <thead>
                <tr>
                    <th>S. No.</th>
                    <th>Document Name</th>
                    <th>View</th>
                    <th>‚úî</th>
                    <th>‚ùå</th>
                    <th>Remarks</th>
                </tr>
            </thead>
            <tbody>
                <% const documents = [
                    { id: 1, name: "Aadhaar Card", type: "image", url: "/uploads/aadhaar.jpg" },
                    { id: 2, name: "PAN Card", type: "image", url: "/uploads/pan.jpg" },
                    { id: 3, name: "Voter ID", type: "image", url: "/uploads/voter.jpg" },
                    { id: 4, name: "Passport", type: "image", url: "/uploads/passport.jpg" },
                    { id: 5, name: "Driving License", type: "image", url: "/uploads/license.jpg" },
                    { id: 6, name: "Electricity Bill", type: "pdf", url: "/uploads/bill.pdf" },
                    { id: 7, name: "Bank Statement", type: "pdf", url: "/uploads/statement.pdf" },
                    { id: 8, name: "Income Tax Return", type: "pdf", url: "/uploads/itr.pdf" }
                ]; %>

                <% documents.forEach((doc, index) => { %>
                <tr>
                    <td><%= index + 1 %></td>
                    <td><%= doc.name %></td>
                    <td>
                        <span class="view-icon" data-url="<%= doc.url %>" data-type="<%= doc.type %>">üëÅ</span>
                    </td>
                    <td>
                        <input type="radio" name="doc_<%= doc.id %>" value="tick">
                    </td>
                    <td>
                        <input type="radio" name="doc_<%= doc.id %>" value="cross">
                    </td>
                    <td>
                        <input type="text" placeholder="Enter remarks">
                    </td>
                </tr>
                <% }); %>
            </tbody>
        </table>
    </div>

    <div class="action-buttons">
        <button class="btn btn-primary" id="correctionBtn">Correction</button>
        <button class="btn btn-primary" id="approveBtn">Approve</button>
    </div>
    
</div>

<!-- Modal for File Preview -->
<div class="modal" id="fileModal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Document Preview</h5>
                <button type="button" class="close" data-bs-dismiss="modal">
                    <span>&times;</span>
                </button>
            </div>
            <div class="modal-body text-center">
                <div id="filePreview"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const viewIcons = document.querySelectorAll(".view-icon");
        const modalElement = document.getElementById("fileModal");
        const modalBody = document.getElementById("filePreview");
        const modalInstance = new bootstrap.Modal(modalElement);

        viewIcons.forEach((icon) => {
            icon.addEventListener("click", function () {
                const fileUrl = this.dataset.url;
                const fileType = this.dataset.type;

                if (fileUrl && fileType) {
                    if (fileType === "image") {
                        modalBody.innerHTML = `<img src="${fileUrl}" style="width: 100%; height: auto;">`;
                    } else if (fileType === "pdf") {
                        modalBody.innerHTML = `<embed src="${fileUrl}" type="application/pdf" width="100%" height="500px" />`;
                    } else {
                        modalBody.innerHTML = `<p>Unsupported file type</p>`;
                    }

                    modalInstance.show();
                }
            });
        });

        // Action Buttons Event
        document.getElementById("correctionBtn").addEventListener("click", function () {
            Swal.fire({
                icon: "warning",
                title: "Correction Requested",
                text: "The user has requested corrections."
            });
        });

        document.getElementById("approveBtn").addEventListener("click", function () {
            Swal.fire({
                icon: "success",
                title: "Approved",
                text: "All documents have been verified."
            });
        });
    });
</script>

<%- include("../shared/footer.ejs") %>
